
# 密码工程实现进阶手册

## 入门级

总练习时间：2个半月。 采用C语言完成以下任务，编写之前只允许看算法原理和相关论文，不能看着他人代码编写；自己写完 后，回头找开源库对比，找到不足之处并改进：

## 任务1-1：编写杂凑函数

时间周期：1周 算法要求：实现SHA-1，SHA-2，SM3等，不少于3种，可自行选择一些杂凑函数来实现； 性能要求：运算速度不低于500Mbps； 技巧要求：

1. 掌握基本代码技巧和内存概念，包括宏定义、大小端、指针、上下文结构体等；

2. 掌握三段式杂凑函数接口；

3. 掌握算法接口的测试方法，包括时间函数、Release模式、差异化样本测试等；

4. 掌握反汇编模式优化方法。 注意事项：

1. 不要成为函数小王子，仅一个哈希函数算法就嵌套多层函数，学会使用宏定义；

2. 要将代码工程化，构建工程结构和统一的Interface接口，不允许所有算法在一个文件中实现；

## 任务1-2：编写分组算法

时间周期：1周 算法要求：实现DES，AES，SM4等，不少于3种，可自行选择一些分组算法来实现； 性能要求：在某个工作模式下运算速度不低于500Mbps； 技巧要求：

1. 掌握最小资源（原理）和最佳性能（T表）实现方式；

2. 掌握分组算法的最简洁接口，即密钥扩展、块加密、块解密；

3. 掌握ECB/CBC等工作模式的实现方法；

## 任务1-3：编写ECC算法

时间周期：4周 算法要求：实现ECDSA签名、SM2签名、SM2加密、ElGamal加密，曲线参数可更换； 性能要求：点乘速度不低于100次/秒； 技巧要求：

1. 掌握基本的大整数运算库，包括大数表示形式、Mont模乘、Barret模乘、Mod运算、Inv运算等；

2. 掌握椭圆曲线的运算规则和实现技巧，了解不少于2种的坐标系；

3. 掌握幂运算或标量乘运算的实现方法，了解不少于3种； 注意事项： 1. 大整数的比特长度可配置；

2. 重点在于大整数库的时间，建议花费3周时间多练习，1周时间实现ECC运算；

## 任务1-4：编写RSA算法

时间要求：4周 算法要求：RSA算法，私钥长度可配置； 性能要求：密钥生成不低于1次/秒，签名/验签不低于10次/秒； 技巧要求：

1. 掌握素性检测算法，了解概率性判别、确定性判别、伪梅森素数等；

2. 掌握随机数生成方法，包括随机种子、系统函数、伪随机生成函数等；

3. 了解CRT定理的用途，建议使用该技巧实现；

任务1-5：了解PKCS工程标准

时间要求：不定 基本要求：

1. 掌握ASN.1语法规则和DER、CER、BASE64等编码，了解msgpack等新编码结构；

2. 能够阐述X.509证书格式，包括算法标识、公钥字段、密钥用途；

3. 能够描述SSL协议或其他标准的安全协议。